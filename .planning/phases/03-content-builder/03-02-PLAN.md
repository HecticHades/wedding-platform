---
phase: 03-content-builder
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/lib/content/templates.ts
  - src/app/(platform)/dashboard/templates/page.tsx
  - src/app/(platform)/dashboard/templates/actions.ts
  - src/components/templates/TemplateCard.tsx
  - src/components/templates/TemplatePreview.tsx
  - public/templates/classic-thumb.svg
  - public/templates/modern-thumb.svg
  - public/templates/rustic-thumb.svg
autonomous: true

must_haves:
  truths:
    - "Couple can see at least 3 template options on templates page"
    - "Each template shows a visual preview before selection"
    - "Selecting a template updates wedding's templateId and themeSettings"
    - "Currently selected template is visually indicated"
  artifacts:
    - path: "src/lib/content/templates.ts"
      provides: "Template definitions with theme presets"
      exports: ["templates", "getTemplate"]
    - path: "src/app/(platform)/dashboard/templates/page.tsx"
      provides: "Template selection page"
      min_lines: 40
    - path: "src/app/(platform)/dashboard/templates/actions.ts"
      provides: "Server action to apply template"
      exports: ["applyTemplate"]
    - path: "src/components/templates/TemplateCard.tsx"
      provides: "Individual template card component"
      min_lines: 25
  key_links:
    - from: "src/app/(platform)/dashboard/templates/page.tsx"
      to: "src/app/(platform)/dashboard/templates/actions.ts"
      via: "server action import"
      pattern: "import.*applyTemplate"
    - from: "src/app/(platform)/dashboard/templates/actions.ts"
      to: "prisma.wedding.update"
      via: "database update"
      pattern: "prisma\\.wedding\\.update"
---

<objective>
Create the template selection system where couples can choose from 3+ pre-designed templates, preview them, and apply one to their wedding site.

Purpose: Templates provide a starting point for visual design, setting both the theme colors/fonts and default content section configuration. This gives couples immediate visual appeal without requiring design skills.

Output: Templates page in dashboard showing 3 template options with previews, server action to apply selected template to wedding.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@wedding-platform/.planning/PROJECT.md
@wedding-platform/.planning/ROADMAP.md
@wedding-platform/.planning/phases/03-content-builder/03-RESEARCH.md

# From Plan 01
@wedding-platform/src/lib/content/theme-utils.ts
@wedding-platform/src/types/prisma-json.d.ts

# Existing patterns
@wedding-platform/src/app/(platform)/dashboard/page.tsx
@wedding-platform/src/lib/db/prisma.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create template definitions and preview thumbnails</name>
  <files>
    - src/lib/content/templates.ts
    - public/templates/classic-thumb.svg
    - public/templates/modern-thumb.svg
    - public/templates/rustic-thumb.svg
  </files>
  <action>
Create src/lib/content/templates.ts with Template interface and 3 template definitions:

1. **Classic Elegance** (id: "classic")
   - Primary: #8B5CF6 (purple), Secondary: #EC4899 (pink)
   - Background: #FFFFFF, Text: #1F2937
   - Fonts: Playfair Display (body), Great Vibes (heading)
   - Default sections: all 6 types

2. **Modern Minimal** (id: "modern")
   - Primary: #000000 (black), Secondary: #6B7280 (gray)
   - Background: #FAFAFA, Text: #111827
   - Fonts: Inter (body), Montserrat (heading)
   - Default sections: event-details, our-story, gallery, timeline, contact

3. **Rustic Romance** (id: "rustic")
   - Primary: #92400E (brown), Secondary: #B45309 (amber)
   - Background: #FFFBEB (cream), Text: #78350F
   - Fonts: Merriweather (body), Sacramento (heading)
   - Default sections: event-details, our-story, travel, gallery, contact

Each template has: id, name, description, thumbnail path, theme (ThemeSettings), defaultSections array.

Export: templates array, getTemplate(id) function.

Create simple SVG thumbnails in public/templates/ that show a stylized wedding site preview with each template's color scheme. Can be abstract color blocks representing header, content, footer.
  </action>
  <verify>
- File exists and exports templates array with 3 items
- Each template has required fields: id, name, theme, defaultSections
- SVG files exist in public/templates/
  </verify>
  <done>3 template definitions exist with distinct theme presets and visual thumbnails</done>
</task>

<task type="auto">
  <name>Task 2: Create template selection page and components</name>
  <files>
    - src/app/(platform)/dashboard/templates/page.tsx
    - src/app/(platform)/dashboard/templates/actions.ts
    - src/components/templates/TemplateCard.tsx
    - src/components/templates/TemplatePreview.tsx
  </files>
  <action>
Create src/components/templates/TemplateCard.tsx:
- Props: template (Template), isSelected (boolean), onSelect callback
- Display: thumbnail image, name, description
- Visual state: border highlight when selected, "Current" badge if active
- Button: "Select Template" or "Selected" based on state

Create src/components/templates/TemplatePreview.tsx:
- Props: theme (ThemeSettings)
- Renders a mini preview of the wedding site with theme applied
- Shows: heading with couple names placeholder, body text sample, accent button
- Uses ThemeProvider pattern from research (inline CSS variables)

Create src/app/(platform)/dashboard/templates/actions.ts:
- "use server" directive
- applyTemplate(templateId: string) server action
- Validates session and tenant context
- Gets template by ID, updates wedding with:
  - templateId: templateId
  - themeSettings: template.theme
  - If contentSections is empty, initialize with template's defaultSections (create empty section objects with correct types and order)
- revalidatePath("/dashboard/templates")
- Returns { success: true } or { error: string }

Create src/app/(platform)/dashboard/templates/page.tsx:
- Server component that fetches current wedding's templateId
- Uses withTenantContext pattern from dashboard/page.tsx
- Renders grid of TemplateCard components (3 columns on lg, 1 on mobile)
- Passes isSelected based on current templateId
- Client wrapper for selection handling (useTransition for pending state)
  </action>
  <verify>
- Navigate to /dashboard/templates shows 3 template options
- Current template (default: classic) has "Selected" indicator
- Clicking a different template triggers server action
  </verify>
  <done>Template selection page displays 3 options and allows couple to select one</done>
</task>

<task type="auto">
  <name>Task 3: Add templates link to dashboard and verify flow</name>
  <files>
    - src/app/(platform)/dashboard/page.tsx
    - src/app/(platform)/dashboard/layout.tsx
  </files>
  <action>
Update src/app/(platform)/dashboard/page.tsx:
- Replace "Edit Content (Coming in Phase 3)" placeholder with actual links
- Add link to "/dashboard/templates" labeled "Choose Template"
- Add link to "/dashboard/theme" labeled "Customize Theme" (page created in plan 03)
- Add link to "/dashboard/content" labeled "Edit Content" (page created in plan 04)
- Style as actual buttons/links instead of gray placeholder spans

If dashboard/layout.tsx exists with nav, add navigation links there as well:
- Templates
- Theme
- Content

Ensure the flow works: Dashboard -> Templates -> Select template -> See confirmation
  </action>
  <verify>
- Dashboard shows working links to templates, theme, content pages
- Full flow: Login as couple -> Dashboard -> Templates -> Select "Modern Minimal" -> Template updates
- Check database: wedding.templateId is "modern", wedding.themeSettings has Modern theme colors
  </verify>
  <done>Dashboard links to template selection, full selection flow works end-to-end</done>
</task>

</tasks>

<verification>
1. /dashboard/templates page loads without error for logged-in couple
2. 3 templates displayed with thumbnails, names, descriptions
3. Currently selected template shows visual indicator
4. Selecting different template:
   - Shows loading/pending state
   - Updates database (verify with Prisma Studio or query)
   - Page reflects new selection
5. Newly created wedding gets default "classic" template
6. Dashboard quick actions have working links
</verification>

<success_criteria>
- Couple can view at least 3 template designs on /dashboard/templates
- Each template has visual preview (thumbnail or live preview)
- Couple can select a template and see it marked as current
- Selection persists to database (templateId and themeSettings updated)
- Dashboard navigation includes links to content builder pages
</success_criteria>

<output>
After completion, create `.planning/phases/03-content-builder/03-02-SUMMARY.md`
</output>
